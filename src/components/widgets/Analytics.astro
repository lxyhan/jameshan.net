<div class="analytics">
  <span class="analytics-text" id="analytics-stats">
    <span class="loading">...</span>
  </span>
</div>

<script>
  async function fetchAnalytics() {
    try {
      const response = await fetch('/api/analytics');
      if (response.ok) {
        const data = await response.json();
        const statsElement = document.getElementById('analytics-stats');
        if (statsElement) {
          statsElement.innerHTML = `${data.today} views today`;
        }
      }
    } catch (error) {
      console.debug('Failed to fetch analytics:', error);
      const statsElement = document.getElementById('analytics-stats');
      if (statsElement) {
        statsElement.innerHTML = '-- views today';
      }
    }
  }

  // Fetch on page load
  fetchAnalytics();

  // Re-fetch on View Transitions navigation
  document.addEventListener('astro:page-load', () => {
    fetchAnalytics();
  });
</script>

<style>
  .analytics {
    font-size: 0.75rem;
    color: var(--text-secondary);
    opacity: 0.8;
    margin-top: var(--spacing-xs, 0.5rem);
  }

  .analytics-text {
    font-family: var(--serif);
  }

  .loading {
    opacity: 0.5;
  }

  @media (max-width: 768px) {
    .analytics {
      font-size: 0.7rem;
    }
  }
</style>
